# 税務書類自動リネームシステム - 実行版

## 🚀 これだけで実行可能！

このフォルダには、税務書類を自動的にリネーム・振り分けするために必要な最小限のファイルが含まれています。

## 📁 含まれるファイル

```
release/
├── standalone-runner.js    # コマンドライン版実行ファイル
├── gui.html              # Web UI インターフェース
├── gui-launcher.js       # GUI版サーバー
├── start-gui.bat         # GUI簡単起動（Windows）
├── run.bat               # CUI版実行バッチ
├── demo.bat              # デモ実行
├── package.json          # 最小限の設定
├── README.md             # このファイル
└── USAGE.md              # 詳細な使用方法
```

## 🔧 必要な環境

- Node.js v14以上（それだけ！）
- 外部ライブラリ不要
- インストール不要

## 📋 使い方

### 🖥️ GUI版（推奨）- ファイル監視機能付き

#### Windows:
```bash
start-gui.bat
```

#### その他:
```bash
node gui-launcher.js
```

ブラウザが自動的に開き、以下の機能が使えます：
- 📁 **フォルダ監視**: 新規ファイルを自動検出
- 🔄 **リアルタイムプレビュー**: リネーム結果を事前確認
- ✅ **一括処理**: 選択したファイルをまとめて処理
- 📊 **処理ログ**: 結果をリアルタイム表示

### 💻 コマンドライン版

#### 1. 基本的な使用方法
```bash
node standalone-runner.js <入力フォルダ> <出力フォルダ>
```

例:
```bash
node standalone-runner.js C:\Downloads C:\TaxDocs\2024
```

#### 2. バッチファイル使用
```bash
run.bat "C:\Downloads" "D:\税務書類\2024"
```

#### 3. デモモード
```bash
demo.bat
```

## 🎯 処理される書類

以下の税務書類を自動的に認識してリネームします：

### e-Tax/eLTAX形式
- `法人税及び地方法人税申告書_20240731[法人名]_20250720130102.pdf`
  → `0001_法人税及び地方法人税申告書_2407.pdf`

- `消費税申告書_20240731[法人名]_20250720130433.pdf`
  → `3001_消費税及び地方消費税申告書_2407.pdf`

- `東京都　法人都道府県民税・事業税...`
  → `1000_都道府県税申告書_2407.pdf`

### 手動ダウンロード形式
- `法人税　受信通知.pdf` → `0003_受信通知_2407.pdf`
- `決算書_20250720_1535.pdf` → `5001_決算書_2407.pdf`
- `固定資産台帳.pdf` → `6001_固定資産台帳_2407.pdf`

## 📂 自動作成されるフォルダ構造

```
出力フォルダ/
├── 0000番台_法人税/
├── 1000番台_都道府県税/
├── 2000番台_市民税/
├── 3000番台_消費税/
├── 5000番台_決算書類/
├── 6000番台_固定資産/
├── 7000番台_税区分集計表/
├── その他/
└── .backup/  （元ファイルのバックアップ）
```

## ⚡ 特徴

- **高速処理**: 1000ファイルでも数秒で完了
- **安全性**: 元ファイルは`.backup`フォルダに保存
- **正確性**: 税務書類を正確に分類
- **シンプル**: 外部依存なし、設定不要

## 🔍 処理の流れ

1. 指定フォルダ内のPDF/CSVファイルを検出
2. ファイル名から書類種別・会社名・決算期を解析
3. 番号体系に基づいて新しいファイル名を生成
4. カテゴリ別フォルダに振り分けて保存
5. 処理結果のサマリーを表示

## ⚠️ 注意事項

- 元ファイルは移動されます（バックアップは`.backup`フォルダに保存）
- 同名ファイルがある場合は上書きされません
- 認識できないファイルは「その他」フォルダに移動

## 💡 トラブルシューティング

**Q: ファイルが処理されない**
A: ファイル名がe-Tax形式または既知のパターンか確認してください

**Q: エラーが出る**
A: フォルダへの書き込み権限があるか確認してください

**Q: 決算期が正しくない**
A: デフォルトで「2407」が使用されます。必要に応じて手動修正してください

## 📞 サポート

問題が発生した場合は、以下を確認してください：
1. Node.jsが正しくインストールされているか
2. 入力・出力フォルダのパスが正しいか
3. ファイルへのアクセス権限があるか